import{u as Vt,r as re,j as g,m as At,R as P,a as pt,b as Dt,s as Et,c as kt}from"./index-B3-YrWFR.js";import{C as Q,T as Ce,M as St}from"./TooltipWrapper-Cm4qRxh5.js";const Ct=()=>{const e=Vt(a=>a.chat.messages),r=re.useRef(null);re.useEffect(()=>{r.current&&r.current.scrollIntoView({behavior:"smooth"})},[e]);const s=a=>new Date(a).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return e.length===0?g.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-50 rounded-md",children:g.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[g.jsx("img",{src:At,alt:"Magi Logo",className:"w-24 opacity-90"}),g.jsxs("p",{className:"text-lg font-bold font-sans text-gray-500",children:[g.jsxs("span",{className:"text-[#15477A]",children:["Welcome"," "]}),g.jsx("span",{className:"text-[#AA0732]",children:"Guest"})]})]})}):(console.log("ChatMessageBody rendered"),g.jsxs("div",{className:"flex-1 overflow-y-auto px-3 py-2 space-y-4 bg-gray-50 rounded-md",children:[e.map(a=>g.jsxs("div",{className:`flex ${a.sender==="user"?"justify-end":"justify-start"}`,children:[g.jsx("div",{className:`max-w-xs md:max-w-md lg:max-w-lg px-4 py-2 rounded-lg text-sm shadow-md ${a.sender==="user"?"bg-[#15477A] text-white rounded-br-none":"bg-[#AA0732] text-white rounded-bl-none"}`,children:a.sender==="receiver"&&a.content===""?g.jsx("div",{className:"w-32 h-5 bg-white/40 rounded animate-pulse"}):a.content}),g.jsx("span",{className:"text-xs text-gray-500 mt-0.5 px-2 self-end",children:s(a.timestamp)})]},a.timestamp)),g.jsx("div",{ref:r})]}))},Nt=()=>{const[e,r]=re.useState(!1),s=re.useRef(null),a=g.jsx("span",{className:"material-icons text-blue-500",children:"chat"}),o=g.jsx("span",{className:"material-icons text-blue-500",children:"account_circle"}),l=g.jsx("span",{className:"material-icons",children:"close"}),y=e?"✕":"☰";return re.useEffect(()=>{const d=L=>{e&&s.current&&!s.current.contains(L.target)&&r(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[e]),g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"sm:hidden relative",ref:s,children:[g.jsx(Q,{label:"",usage:"icon",onClick:()=>r(d=>!d),customContent:g.jsx("span",{className:"text-xl",children:y})}),e&&g.jsxs("div",{className:"absolute right-0 mt-2 w-32 bg-white rounded-lg shadow-lg py-2 z-50 flex flex-col items-start gap-2 px-3",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Q,{label:"",usage:"icon",variant:"secondary",customContent:a}),g.jsx("span",{className:"text-sm text-gray-700",children:"New Chat"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Q,{label:"",usage:"icon",variant:"secondary",customContent:o}),g.jsx("span",{className:"text-sm text-gray-700",children:"Profile"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Q,{label:"",usage:"icon",variant:"danger",customContent:l}),g.jsx("span",{className:"text-sm text-gray-700",children:"Close"})]})]})]}),g.jsxs("div",{className:"hidden sm:flex gap-4 items-center",children:[g.jsx(Ce,{tooltipText:"New Chat",children:g.jsx(Q,{label:"",usage:"icon",variant:"secondary",customContent:a})}),g.jsx(Ce,{tooltipText:"Profile",children:g.jsx(Q,{label:"",usage:"icon",variant:"secondary",customContent:o})}),g.jsx(Ce,{tooltipText:"Close",children:g.jsx(Q,{label:"",usage:"icon",variant:"danger",customContent:l})})]})]})},jt=()=>(console.log("Chat Header rendered"),g.jsx("div",{className:"w-full px-4 sm:px-8 lg:px-14 py-1 backdrop-blur-xl bg-white/30 shadow-md relative z-10",children:g.jsxs("div",{className:"flex justify-between items-center relative",children:[g.jsx("div",{children:g.jsx("img",{src:St,alt:"Magi Logo",className:"w-[160px] sm:w-[200px] h-[80px] sm:h-[100px] object-contain"})}),g.jsx(Nt,{})]})}));var he=e=>e.type==="checkbox",ae=e=>e instanceof Date,R=e=>e==null;const nt=e=>typeof e=="object";var E=e=>!R(e)&&!Array.isArray(e)&&nt(e)&&!ae(e),Lt=e=>E(e)&&e.target?he(e.target)?e.target.checked:e.target.value:e,Tt=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,Mt=(e,r)=>e.has(Tt(r)),Rt=e=>{const r=e.constructor&&e.constructor.prototype;return E(r)&&r.hasOwnProperty("isPrototypeOf")},Le=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function T(e){let r;const s=Array.isArray(e),a=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)r=new Date(e);else if(!(Le&&(e instanceof Blob||a))&&(s||E(e)))if(r=s?[]:{},!s&&!Rt(e))r=e;else for(const o in e)e.hasOwnProperty(o)&&(r[o]=T(e[o]));else return e;return r}var Fe=e=>/^\w*$/.test(e),S=e=>e===void 0,Te=e=>Array.isArray(e)?e.filter(Boolean):[],Me=e=>Te(e.replace(/["|']|\]/g,"").split(/\.|\[/)),h=(e,r,s)=>{if(!r||!E(e))return s;const a=(Fe(r)?[r]:Me(r)).reduce((o,l)=>R(o)?o:o[l],e);return S(a)||a===e?S(e[r])?s:e[r]:a},K=e=>typeof e=="boolean",p=(e,r,s)=>{let a=-1;const o=Fe(r)?[r]:Me(r),l=o.length,y=l-1;for(;++a<l;){const d=o[a];let L=s;if(a!==y){const C=e[d];L=E(C)||Array.isArray(C)?C:isNaN(+o[a+1])?{}:[]}if(d==="__proto__"||d==="constructor"||d==="prototype")return;e[d]=L,e=e[d]}};const Ye={BLUR:"blur",FOCUS_OUT:"focusout"},q={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},J={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Ot=P.createContext(null);Ot.displayName="HookFormContext";var It=(e,r,s,a=!0)=>{const o={defaultValues:r._defaultValues};for(const l in e)Object.defineProperty(o,l,{get:()=>{const y=l;return r._proxyFormState[y]!==q.all&&(r._proxyFormState[y]=!a||q.all),e[y]}});return o};const Ut=typeof window<"u"?re.useLayoutEffect:re.useEffect;var Y=e=>typeof e=="string",Bt=(e,r,s,a,o)=>Y(e)?(a&&r.watch.add(e),h(s,e,o)):Array.isArray(e)?e.map(l=>(a&&r.watch.add(l),h(s,l))):(a&&(r.watchAll=!0),s),Pt=(e,r,s,a,o)=>r?{...s[e],types:{...s[e]&&s[e].types?s[e].types:{},[a]:o||!0}}:{},fe=e=>Array.isArray(e)?e:[e],Ge=()=>{let e=[];return{get observers(){return e},next:o=>{for(const l of e)l.next&&l.next(o)},subscribe:o=>(e.push(o),{unsubscribe:()=>{e=e.filter(l=>l!==o)}}),unsubscribe:()=>{e=[]}}},je=e=>R(e)||!nt(e);function se(e,r,s=new WeakSet){if(je(e)||je(r))return e===r;if(ae(e)&&ae(r))return e.getTime()===r.getTime();const a=Object.keys(e),o=Object.keys(r);if(a.length!==o.length)return!1;if(s.has(e)||s.has(r))return!0;s.add(e),s.add(r);for(const l of a){const y=e[l];if(!o.includes(l))return!1;if(l!=="ref"){const d=r[l];if(ae(y)&&ae(d)||E(y)&&E(d)||Array.isArray(y)&&Array.isArray(d)?!se(y,d,s):y!==d)return!1}}return!0}var I=e=>E(e)&&!Object.keys(e).length,Re=e=>e.type==="file",W=e=>typeof e=="function",be=e=>{if(!Le)return!1;const r=e?e.ownerDocument:0;return e instanceof(r&&r.defaultView?r.defaultView.HTMLElement:HTMLElement)},lt=e=>e.type==="select-multiple",Oe=e=>e.type==="radio",qt=e=>Oe(e)||he(e),Ne=e=>be(e)&&e.isConnected;function Wt(e,r){const s=r.slice(0,-1).length;let a=0;for(;a<s;)e=S(e)?a++:e[r[a++]];return e}function Ht(e){for(const r in e)if(e.hasOwnProperty(r)&&!S(e[r]))return!1;return!0}function k(e,r){const s=Array.isArray(r)?r:Fe(r)?[r]:Me(r),a=s.length===1?e:Wt(e,s),o=s.length-1,l=s[o];return a&&delete a[l],o!==0&&(E(a)&&I(a)||Array.isArray(a)&&Ht(a))&&k(e,s.slice(0,-1)),e}var ot=e=>{for(const r in e)if(W(e[r]))return!0;return!1};function we(e,r={}){const s=Array.isArray(e);if(E(e)||s)for(const a in e)Array.isArray(e[a])||E(e[a])&&!ot(e[a])?(r[a]=Array.isArray(e[a])?[]:{},we(e[a],r[a])):R(e[a])||(r[a]=!0);return r}function ut(e,r,s){const a=Array.isArray(e);if(E(e)||a)for(const o in e)Array.isArray(e[o])||E(e[o])&&!ot(e[o])?S(r)||je(s[o])?s[o]=Array.isArray(e[o])?we(e[o],[]):{...we(e[o])}:ut(e[o],R(r)?{}:r[o],s[o]):s[o]=!se(e[o],r[o]);return s}var ce=(e,r)=>ut(e,r,we(r));const Je={value:!1,isValid:!1},Qe={value:!0,isValid:!0};var ct=e=>{if(Array.isArray(e)){if(e.length>1){const r=e.filter(s=>s&&s.checked&&!s.disabled).map(s=>s.value);return{value:r,isValid:!!r.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!S(e[0].attributes.value)?S(e[0].value)||e[0].value===""?Qe:{value:e[0].value,isValid:!0}:Qe:Je}return Je},dt=(e,{valueAsNumber:r,valueAsDate:s,setValueAs:a})=>S(e)?e:r?e===""?NaN:e&&+e:s&&Y(e)?new Date(e):a?a(e):e;const Xe={isValid:!1,value:null};var ft=e=>Array.isArray(e)?e.reduce((r,s)=>s&&s.checked&&!s.disabled?{isValid:!0,value:s.value}:r,Xe):Xe;function Ze(e){const r=e.ref;return Re(r)?r.files:Oe(r)?ft(e.refs).value:lt(r)?[...r.selectedOptions].map(({value:s})=>s):he(r)?ct(e.refs).value:dt(S(r.value)?e.ref.value:r.value,e)}var $t=(e,r,s,a)=>{const o={};for(const l of e){const y=h(r,l);y&&p(o,l,y._f)}return{criteriaMode:s,names:[...e],fields:o,shouldUseNativeValidation:a}},_e=e=>e instanceof RegExp,de=e=>S(e)?e:_e(e)?e.source:E(e)?_e(e.value)?e.value.source:e.value:e,et=e=>({isOnSubmit:!e||e===q.onSubmit,isOnBlur:e===q.onBlur,isOnChange:e===q.onChange,isOnAll:e===q.all,isOnTouch:e===q.onTouched});const tt="AsyncFunction";var zt=e=>!!e&&!!e.validate&&!!(W(e.validate)&&e.validate.constructor.name===tt||E(e.validate)&&Object.values(e.validate).find(r=>r.constructor.name===tt)),Kt=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),st=(e,r,s)=>!s&&(r.watchAll||r.watch.has(e)||[...r.watch].some(a=>e.startsWith(a)&&/^\.\w+/.test(e.slice(a.length))));const ye=(e,r,s,a)=>{for(const o of s||Object.keys(e)){const l=h(e,o);if(l){const{_f:y,...d}=l;if(y){if(y.refs&&y.refs[0]&&r(y.refs[0],o)&&!a)return!0;if(y.ref&&r(y.ref,y.name)&&!a)return!0;if(ye(d,r))break}else if(E(d)&&ye(d,r))break}}};function rt(e,r,s){const a=h(e,s);if(a||Fe(s))return{error:a,name:s};const o=s.split(".");for(;o.length;){const l=o.join("."),y=h(r,l),d=h(e,l);if(y&&!Array.isArray(y)&&s!==l)return{name:s};if(d&&d.type)return{name:l,error:d};if(d&&d.root&&d.root.type)return{name:`${l}.root`,error:d.root};o.pop()}return{name:s}}var Yt=(e,r,s,a)=>{s(e);const{name:o,...l}=e;return I(l)||Object.keys(l).length>=Object.keys(r).length||Object.keys(l).find(y=>r[y]===(!a||q.all))},Gt=(e,r,s)=>!e||!r||e===r||fe(e).some(a=>a&&(s?a===r:a.startsWith(r)||r.startsWith(a))),Jt=(e,r,s,a,o)=>o.isOnAll?!1:!s&&o.isOnTouch?!(r||e):(s?a.isOnBlur:o.isOnBlur)?!e:(s?a.isOnChange:o.isOnChange)?e:!0,Qt=(e,r)=>!Te(h(e,r)).length&&k(e,r),Xt=(e,r,s)=>{const a=fe(h(e,s));return p(a,"root",r[s]),p(e,s,a),e},ve=e=>Y(e);function it(e,r,s="validate"){if(ve(e)||Array.isArray(e)&&e.every(ve)||K(e)&&!e)return{type:s,message:ve(e)?e:"",ref:r}}var le=e=>E(e)&&!_e(e)?e:{value:e,message:""},at=async(e,r,s,a,o,l)=>{const{ref:y,refs:d,required:L,maxLength:C,minLength:v,min:_,max:m,pattern:oe,validate:X,name:N,valueAsNumber:Z,mount:Ve}=e._f,w=h(s,N);if(!Ve||r.has(N))return{};const G=d?d[0]:y,H=b=>{o&&G.reportValidity&&(G.setCustomValidity(K(b)?"":b||""),G.reportValidity())},j={},ge=Oe(y),ee=he(y),Ae=ge||ee,B=(Z||Re(y))&&S(y.value)&&S(w)||be(y)&&y.value===""||w===""||Array.isArray(w)&&!w.length,ie=Pt.bind(null,N,a,j),$=(b,V,D,M=J.maxLength,O=J.minLength)=>{const z=b?V:D;j[N]={type:b?M:O,message:z,ref:y,...ie(b?M:O,z)}};if(l?!Array.isArray(w)||!w.length:L&&(!Ae&&(B||R(w))||K(w)&&!w||ee&&!ct(d).isValid||ge&&!ft(d).isValid)){const{value:b,message:V}=ve(L)?{value:!!L,message:L}:le(L);if(b&&(j[N]={type:J.required,message:V,ref:G,...ie(J.required,V)},!a))return H(V),j}if(!B&&(!R(_)||!R(m))){let b,V;const D=le(m),M=le(_);if(!R(w)&&!isNaN(w)){const O=y.valueAsNumber||w&&+w;R(D.value)||(b=O>D.value),R(M.value)||(V=O<M.value)}else{const O=y.valueAsDate||new Date(w),z=xe=>new Date(new Date().toDateString()+" "+xe),ue=y.type=="time",ne=y.type=="week";Y(D.value)&&w&&(b=ue?z(w)>z(D.value):ne?w>D.value:O>new Date(D.value)),Y(M.value)&&w&&(V=ue?z(w)<z(M.value):ne?w<M.value:O<new Date(M.value))}if((b||V)&&($(!!b,D.message,M.message,J.max,J.min),!a))return H(j[N].message),j}if((C||v)&&!B&&(Y(w)||l&&Array.isArray(w))){const b=le(C),V=le(v),D=!R(b.value)&&w.length>+b.value,M=!R(V.value)&&w.length<+V.value;if((D||M)&&($(D,b.message,V.message),!a))return H(j[N].message),j}if(oe&&!B&&Y(w)){const{value:b,message:V}=le(oe);if(_e(b)&&!w.match(b)&&(j[N]={type:J.pattern,message:V,ref:y,...ie(J.pattern,V)},!a))return H(V),j}if(X){if(W(X)){const b=await X(w,s),V=it(b,G);if(V&&(j[N]={...V,...ie(J.validate,V.message)},!a))return H(V.message),j}else if(E(X)){let b={};for(const V in X){if(!I(b)&&!a)break;const D=it(await X[V](w,s),G,V);D&&(b={...D,...ie(V,D.message)},H(D.message),a&&(j[N]=b))}if(!I(b)&&(j[N]={ref:G,...b},!a))return j}}return H(!0),j};const Zt={mode:q.onSubmit,reValidateMode:q.onChange,shouldFocusError:!0};function es(e={}){let r={...Zt,...e},s={submitCount:0,isDirty:!1,isReady:!1,isLoading:W(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1},a={},o=E(r.defaultValues)||E(r.values)?T(r.defaultValues||r.values)||{}:{},l=r.shouldUnregister?{}:T(o),y={action:!1,mount:!1,watch:!1},d={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},L,C=0;const v={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let _={...v};const m={array:Ge(),state:Ge()},oe=r.criteriaMode===q.all,X=t=>i=>{clearTimeout(C),C=setTimeout(t,i)},N=async t=>{if(!r.disabled&&(v.isValid||_.isValid||t)){const i=r.resolver?I((await ee()).errors):await B(a,!0);i!==s.isValid&&m.state.next({isValid:i})}},Z=(t,i)=>{!r.disabled&&(v.isValidating||v.validatingFields||_.isValidating||_.validatingFields)&&((t||Array.from(d.mount)).forEach(n=>{n&&(i?p(s.validatingFields,n,i):k(s.validatingFields,n))}),m.state.next({validatingFields:s.validatingFields,isValidating:!I(s.validatingFields)}))},Ve=(t,i=[],n,f,c=!0,u=!0)=>{if(f&&n&&!r.disabled){if(y.action=!0,u&&Array.isArray(h(a,t))){const x=n(h(a,t),f.argA,f.argB);c&&p(a,t,x)}if(u&&Array.isArray(h(s.errors,t))){const x=n(h(s.errors,t),f.argA,f.argB);c&&p(s.errors,t,x),Qt(s.errors,t)}if((v.touchedFields||_.touchedFields)&&u&&Array.isArray(h(s.touchedFields,t))){const x=n(h(s.touchedFields,t),f.argA,f.argB);c&&p(s.touchedFields,t,x)}(v.dirtyFields||_.dirtyFields)&&(s.dirtyFields=ce(o,l)),m.state.next({name:t,isDirty:$(t,i),dirtyFields:s.dirtyFields,errors:s.errors,isValid:s.isValid})}else p(l,t,i)},w=(t,i)=>{p(s.errors,t,i),m.state.next({errors:s.errors})},G=t=>{s.errors=t,m.state.next({errors:s.errors,isValid:!1})},H=(t,i,n,f)=>{const c=h(a,t);if(c){const u=h(l,t,S(n)?h(o,t):n);S(u)||f&&f.defaultChecked||i?p(l,t,i?u:Ze(c._f)):D(t,u),y.mount&&N()}},j=(t,i,n,f,c)=>{let u=!1,x=!1;const F={name:t};if(!r.disabled){if(!n||f){(v.isDirty||_.isDirty)&&(x=s.isDirty,s.isDirty=F.isDirty=$(),u=x!==F.isDirty);const A=se(h(o,t),i);x=!!h(s.dirtyFields,t),A?k(s.dirtyFields,t):p(s.dirtyFields,t,!0),F.dirtyFields=s.dirtyFields,u=u||(v.dirtyFields||_.dirtyFields)&&x!==!A}if(n){const A=h(s.touchedFields,t);A||(p(s.touchedFields,t,n),F.touchedFields=s.touchedFields,u=u||(v.touchedFields||_.touchedFields)&&A!==n)}u&&c&&m.state.next(F)}return u?F:{}},ge=(t,i,n,f)=>{const c=h(s.errors,t),u=(v.isValid||_.isValid)&&K(i)&&s.isValid!==i;if(r.delayError&&n?(L=X(()=>w(t,n)),L(r.delayError)):(clearTimeout(C),L=null,n?p(s.errors,t,n):k(s.errors,t)),(n?!se(c,n):c)||!I(f)||u){const x={...f,...u&&K(i)?{isValid:i}:{},errors:s.errors,name:t};s={...s,...x},m.state.next(x)}},ee=async t=>{Z(t,!0);const i=await r.resolver(l,r.context,$t(t||d.mount,a,r.criteriaMode,r.shouldUseNativeValidation));return Z(t),i},Ae=async t=>{const{errors:i}=await ee(t);if(t)for(const n of t){const f=h(i,n);f?p(s.errors,n,f):k(s.errors,n)}else s.errors=i;return i},B=async(t,i,n={valid:!0})=>{for(const f in t){const c=t[f];if(c){const{_f:u,...x}=c;if(u){const F=d.array.has(u.name),A=c._f&&zt(c._f);A&&v.validatingFields&&Z([f],!0);const U=await at(c,d.disabled,l,oe,r.shouldUseNativeValidation&&!i,F);if(A&&v.validatingFields&&Z([f]),U[u.name]&&(n.valid=!1,i))break;!i&&(h(U,u.name)?F?Xt(s.errors,U,u.name):p(s.errors,u.name,U[u.name]):k(s.errors,u.name))}!I(x)&&await B(x,i,n)}}return n.valid},ie=()=>{for(const t of d.unMount){const i=h(a,t);i&&(i._f.refs?i._f.refs.every(n=>!Ne(n)):!Ne(i._f.ref))&&pe(t)}d.unMount=new Set},$=(t,i)=>!r.disabled&&(t&&i&&p(l,t,i),!se(xe(),o)),b=(t,i,n)=>Bt(t,d,{...y.mount?l:S(i)?o:Y(t)?{[t]:i}:i},n,i),V=t=>Te(h(y.mount?l:o,t,r.shouldUnregister?h(o,t,[]):[])),D=(t,i,n={})=>{const f=h(a,t);let c=i;if(f){const u=f._f;u&&(!u.disabled&&p(l,t,dt(i,u)),c=be(u.ref)&&R(i)?"":i,lt(u.ref)?[...u.ref.options].forEach(x=>x.selected=c.includes(x.value)):u.refs?he(u.ref)?u.refs.forEach(x=>{(!x.defaultChecked||!x.disabled)&&(Array.isArray(c)?x.checked=!!c.find(F=>F===x.value):x.checked=c===x.value||!!c)}):u.refs.forEach(x=>x.checked=x.value===c):Re(u.ref)?u.ref.value="":(u.ref.value=c,u.ref.type||m.state.next({name:t,values:T(l)})))}(n.shouldDirty||n.shouldTouch)&&j(t,c,n.shouldTouch,n.shouldDirty,!0),n.shouldValidate&&ne(t)},M=(t,i,n)=>{for(const f in i){if(!i.hasOwnProperty(f))return;const c=i[f],u=t+"."+f,x=h(a,u);(d.array.has(t)||E(c)||x&&!x._f)&&!ae(c)?M(u,c,n):D(u,c,n)}},O=(t,i,n={})=>{const f=h(a,t),c=d.array.has(t),u=T(i);p(l,t,u),c?(m.array.next({name:t,values:T(l)}),(v.isDirty||v.dirtyFields||_.isDirty||_.dirtyFields)&&n.shouldDirty&&m.state.next({name:t,dirtyFields:ce(o,l),isDirty:$(t,u)})):f&&!f._f&&!R(u)?M(t,u,n):D(t,u,n),st(t,d)&&m.state.next({...s}),m.state.next({name:y.mount?t:void 0,values:T(l)})},z=async t=>{y.mount=!0;const i=t.target;let n=i.name,f=!0;const c=h(a,n),u=A=>{f=Number.isNaN(A)||ae(A)&&isNaN(A.getTime())||se(A,h(l,n,A))},x=et(r.mode),F=et(r.reValidateMode);if(c){let A,U;const me=i.type?Ze(c._f):Lt(t),te=t.type===Ye.BLUR||t.type===Ye.FOCUS_OUT,wt=!Kt(c._f)&&!r.resolver&&!h(s.errors,n)&&!c._f.deps||Jt(te,h(s.touchedFields,n),s.isSubmitted,F,x),ke=st(n,d,te);p(l,n,me),te?(c._f.onBlur&&c._f.onBlur(t),L&&L(0)):c._f.onChange&&c._f.onChange(t);const Se=j(n,me,te),_t=!I(Se)||ke;if(!te&&m.state.next({name:n,type:t.type,values:T(l)}),wt)return(v.isValid||_.isValid)&&(r.mode==="onBlur"?te&&N():te||N()),_t&&m.state.next({name:n,...ke?{}:Se});if(!te&&ke&&m.state.next({...s}),r.resolver){const{errors:ze}=await ee([n]);if(u(me),f){const Ft=rt(s.errors,a,n),Ke=rt(ze,a,Ft.name||n);A=Ke.error,n=Ke.name,U=I(ze)}}else Z([n],!0),A=(await at(c,d.disabled,l,oe,r.shouldUseNativeValidation))[n],Z([n]),u(me),f&&(A?U=!1:(v.isValid||_.isValid)&&(U=await B(a,!0)));f&&(c._f.deps&&ne(c._f.deps),ge(n,U,A,Se))}},ue=(t,i)=>{if(h(s.errors,i)&&t.focus)return t.focus(),1},ne=async(t,i={})=>{let n,f;const c=fe(t);if(r.resolver){const u=await Ae(S(t)?t:c);n=I(u),f=t?!c.some(x=>h(u,x)):n}else t?(f=(await Promise.all(c.map(async u=>{const x=h(a,u);return await B(x&&x._f?{[u]:x}:x)}))).every(Boolean),!(!f&&!s.isValid)&&N()):f=n=await B(a);return m.state.next({...!Y(t)||(v.isValid||_.isValid)&&n!==s.isValid?{}:{name:t},...r.resolver||!t?{isValid:n}:{},errors:s.errors}),i.shouldFocus&&!f&&ye(a,ue,t?c:d.mount),f},xe=t=>{const i={...y.mount?l:o};return S(t)?i:Y(t)?h(i,t):t.map(n=>h(i,n))},Ie=(t,i)=>({invalid:!!h((i||s).errors,t),isDirty:!!h((i||s).dirtyFields,t),error:h((i||s).errors,t),isValidating:!!h(s.validatingFields,t),isTouched:!!h((i||s).touchedFields,t)}),yt=t=>{t&&fe(t).forEach(i=>k(s.errors,i)),m.state.next({errors:t?s.errors:{}})},Ue=(t,i,n)=>{const f=(h(a,t,{_f:{}})._f||{}).ref,c=h(s.errors,t)||{},{ref:u,message:x,type:F,...A}=c;p(s.errors,t,{...A,...i,ref:f}),m.state.next({name:t,errors:s.errors,isValid:!1}),n&&n.shouldFocus&&f&&f.focus&&f.focus()},ht=(t,i)=>W(t)?m.state.subscribe({next:n=>t(b(void 0,i),n)}):b(t,i,!0),Be=t=>m.state.subscribe({next:i=>{Gt(t.name,i.name,t.exact)&&Yt(i,t.formState||v,bt,t.reRenderRoot)&&t.callback({values:{...l},...s,...i})}}).unsubscribe,gt=t=>(y.mount=!0,_={..._,...t.formState},Be({...t,formState:_})),pe=(t,i={})=>{for(const n of t?fe(t):d.mount)d.mount.delete(n),d.array.delete(n),i.keepValue||(k(a,n),k(l,n)),!i.keepError&&k(s.errors,n),!i.keepDirty&&k(s.dirtyFields,n),!i.keepTouched&&k(s.touchedFields,n),!i.keepIsValidating&&k(s.validatingFields,n),!r.shouldUnregister&&!i.keepDefaultValue&&k(o,n);m.state.next({values:T(l)}),m.state.next({...s,...i.keepDirty?{isDirty:$()}:{}}),!i.keepIsValid&&N()},Pe=({disabled:t,name:i})=>{(K(t)&&y.mount||t||d.disabled.has(i))&&(t?d.disabled.add(i):d.disabled.delete(i))},De=(t,i={})=>{let n=h(a,t);const f=K(i.disabled)||K(r.disabled);return p(a,t,{...n||{},_f:{...n&&n._f?n._f:{ref:{name:t}},name:t,mount:!0,...i}}),d.mount.add(t),n?Pe({disabled:K(i.disabled)?i.disabled:r.disabled,name:t}):H(t,!0,i.value),{...f?{disabled:i.disabled||r.disabled}:{},...r.progressive?{required:!!i.required,min:de(i.min),max:de(i.max),minLength:de(i.minLength),maxLength:de(i.maxLength),pattern:de(i.pattern)}:{},name:t,onChange:z,onBlur:z,ref:c=>{if(c){De(t,i),n=h(a,t);const u=S(c.value)&&c.querySelectorAll&&c.querySelectorAll("input,select,textarea")[0]||c,x=qt(u),F=n._f.refs||[];if(x?F.find(A=>A===u):u===n._f.ref)return;p(a,t,{_f:{...n._f,...x?{refs:[...F.filter(Ne),u,...Array.isArray(h(o,t))?[{}]:[]],ref:{type:u.type,name:t}}:{ref:u}}}),H(t,!1,void 0,u)}else n=h(a,t,{}),n._f&&(n._f.mount=!1),(r.shouldUnregister||i.shouldUnregister)&&!(Mt(d.array,t)&&y.action)&&d.unMount.add(t)}}},Ee=()=>r.shouldFocusError&&ye(a,ue,d.mount),xt=t=>{K(t)&&(m.state.next({disabled:t}),ye(a,(i,n)=>{const f=h(a,n);f&&(i.disabled=f._f.disabled||t,Array.isArray(f._f.refs)&&f._f.refs.forEach(c=>{c.disabled=f._f.disabled||t}))},0,!1))},qe=(t,i)=>async n=>{let f;n&&(n.preventDefault&&n.preventDefault(),n.persist&&n.persist());let c=T(l);if(m.state.next({isSubmitting:!0}),r.resolver){const{errors:u,values:x}=await ee();s.errors=u,c=T(x)}else await B(a);if(d.disabled.size)for(const u of d.disabled)k(c,u);if(k(s.errors,"root"),I(s.errors)){m.state.next({errors:{}});try{await t(c,n)}catch(u){f=u}}else i&&await i({...s.errors},n),Ee(),setTimeout(Ee);if(m.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:I(s.errors)&&!f,submitCount:s.submitCount+1,errors:s.errors}),f)throw f},mt=(t,i={})=>{h(a,t)&&(S(i.defaultValue)?O(t,T(h(o,t))):(O(t,i.defaultValue),p(o,t,T(i.defaultValue))),i.keepTouched||k(s.touchedFields,t),i.keepDirty||(k(s.dirtyFields,t),s.isDirty=i.defaultValue?$(t,T(h(o,t))):$()),i.keepError||(k(s.errors,t),v.isValid&&N()),m.state.next({...s}))},We=(t,i={})=>{const n=t?T(t):o,f=T(n),c=I(t),u=c?o:f;if(i.keepDefaultValues||(o=n),!i.keepValues){if(i.keepDirtyValues){const x=new Set([...d.mount,...Object.keys(ce(o,l))]);for(const F of Array.from(x))h(s.dirtyFields,F)?p(u,F,h(l,F)):O(F,h(u,F))}else{if(Le&&S(t))for(const x of d.mount){const F=h(a,x);if(F&&F._f){const A=Array.isArray(F._f.refs)?F._f.refs[0]:F._f.ref;if(be(A)){const U=A.closest("form");if(U){U.reset();break}}}}if(i.keepFieldsRef)for(const x of d.mount)O(x,h(u,x));else a={}}l=r.shouldUnregister?i.keepDefaultValues?T(o):{}:T(u),m.array.next({values:{...u}}),m.state.next({values:{...u}})}d={mount:i.keepDirtyValues?d.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},y.mount=!v.isValid||!!i.keepIsValid||!!i.keepDirtyValues,y.watch=!!r.shouldUnregister,m.state.next({submitCount:i.keepSubmitCount?s.submitCount:0,isDirty:c?!1:i.keepDirty?s.isDirty:!!(i.keepDefaultValues&&!se(t,o)),isSubmitted:i.keepIsSubmitted?s.isSubmitted:!1,dirtyFields:c?{}:i.keepDirtyValues?i.keepDefaultValues&&l?ce(o,l):s.dirtyFields:i.keepDefaultValues&&t?ce(o,t):i.keepDirty?s.dirtyFields:{},touchedFields:i.keepTouched?s.touchedFields:{},errors:i.keepErrors?s.errors:{},isSubmitSuccessful:i.keepIsSubmitSuccessful?s.isSubmitSuccessful:!1,isSubmitting:!1})},He=(t,i)=>We(W(t)?t(l):t,i),vt=(t,i={})=>{const n=h(a,t),f=n&&n._f;if(f){const c=f.refs?f.refs[0]:f.ref;c.focus&&(c.focus(),i.shouldSelect&&W(c.select)&&c.select())}},bt=t=>{s={...s,...t}},$e={control:{register:De,unregister:pe,getFieldState:Ie,handleSubmit:qe,setError:Ue,_subscribe:Be,_runSchema:ee,_focusError:Ee,_getWatch:b,_getDirty:$,_setValid:N,_setFieldArray:Ve,_setDisabledField:Pe,_setErrors:G,_getFieldArray:V,_reset:We,_resetDefaultValues:()=>W(r.defaultValues)&&r.defaultValues().then(t=>{He(t,r.resetOptions),m.state.next({isLoading:!1})}),_removeUnmounted:ie,_disableForm:xt,_subjects:m,_proxyFormState:v,get _fields(){return a},get _formValues(){return l},get _state(){return y},set _state(t){y=t},get _defaultValues(){return o},get _names(){return d},set _names(t){d=t},get _formState(){return s},get _options(){return r},set _options(t){r={...r,...t}}},subscribe:gt,trigger:ne,register:De,handleSubmit:qe,watch:ht,setValue:O,getValues:xe,reset:He,resetField:mt,clearErrors:yt,unregister:pe,setError:Ue,setFocus:vt,getFieldState:Ie};return{...$e,formControl:$e}}function ts(e={}){const r=P.useRef(void 0),s=P.useRef(void 0),[a,o]=P.useState({isDirty:!1,isValidating:!1,isLoading:W(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:W(e.defaultValues)?void 0:e.defaultValues});if(!r.current)if(e.formControl)r.current={...e.formControl,formState:a},e.defaultValues&&!W(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:y,...d}=es(e);r.current={...d,formState:a}}const l=r.current.control;return l._options=e,Ut(()=>{const y=l._subscribe({formState:l._proxyFormState,callback:()=>o({...l._formState}),reRenderRoot:!0});return o(d=>({...d,isReady:!0})),l._formState.isReady=!0,y},[l]),P.useEffect(()=>l._disableForm(e.disabled),[l,e.disabled]),P.useEffect(()=>{e.mode&&(l._options.mode=e.mode),e.reValidateMode&&(l._options.reValidateMode=e.reValidateMode)},[l,e.mode,e.reValidateMode]),P.useEffect(()=>{e.errors&&(l._setErrors(e.errors),l._focusError())},[l,e.errors]),P.useEffect(()=>{e.shouldUnregister&&l._subjects.state.next({values:l._getWatch()})},[l,e.shouldUnregister]),P.useEffect(()=>{if(l._proxyFormState.isDirty){const y=l._getDirty();y!==a.isDirty&&l._subjects.state.next({isDirty:y})}},[l,a.isDirty]),P.useEffect(()=>{e.values&&!se(e.values,s.current)?(l._reset(e.values,{keepFieldsRef:!0,...l._options.resetOptions}),s.current=e.values,o(y=>({...y}))):l._resetDefaultValues()},[l,e.values]),P.useEffect(()=>{l._state.mount||(l._setValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),r.current.formState=It(a,l),r.current}const ss=()=>{const e=pt(),{register:r,handleSubmit:s,formState:{errors:a},reset:o}=ts(),[l]=Dt(),y=async C=>{const v=C.message.trim();if(v){e(Et({content:v})),o();try{const _=await l({query:v}).unwrap();let m="";"content"in _&&typeof _.content=="string"?m=_.content:"response"in _&&typeof _.response=="string"&&(m=_.response),e(kt({content:m}))}catch(_){console.error("Failed to send message:",_)}}},d=g.jsx(Q,{label:"",usage:"icon",variant:"secondary",type:"button",customContent:g.jsx("span",{className:"material-icons",children:"add"})}),L=g.jsx(Q,{label:"",usage:"icon",variant:"danger",type:"submit",customContent:g.jsx("span",{className:"material-icons",children:"send"})});return re.useEffect(()=>{console.log("Chat Input rendered")},[]),g.jsx("form",{onSubmit:s(y),className:"p-2 bg-white w-full",children:g.jsxs("div",{className:`border rounded-2xl shadow-md flex flex-col gap-2 p-2 ${a.message?"border-red-500":"border-gray-300"}`,children:[g.jsx("textarea",{...r("message",{required:!0}),placeholder:"Ask Magi",onInput:C=>{const v=C.target;v.style.height="auto",v.style.height=`${v.scrollHeight}px`},onKeyDown:C=>{if(C.key==="Enter"&&!C.shiftKey){C.preventDefault();const v=C.target.closest("form");v&&v.requestSubmit()}},className:"w-full resize-none overflow-hidden outline-none p-1 border-none focus:ring-0",rows:1}),g.jsxs("div",{className:"flex justify-between items-center px-1",children:[d,L,g.jsx("button",{type:"submit",style:{display:"none"},"aria-hidden":"true",tabIndex:-1})]})]})})},ns=()=>g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"w-full",children:g.jsx(jt,{})}),g.jsxs("div",{className:"flex flex-col h-[calc(100vh-110px)] max-w-5xl mx-auto rounded",children:[g.jsx(Ct,{}),g.jsx(ss,{})]})]});export{ns as default};
